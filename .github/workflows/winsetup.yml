name: setup-windows-server

on: [push, pull_request]

jobs:
  setup-windows-server:
    runs-on: windows-latest

    steps:
      - name: Check out Repository
        uses: actions/checkout@v3

      - name: Download RustDesk Installer
        run: |
          Invoke-WebRequest -Uri "https://github.com/rustdesk/rustdesk/releases/download/1.2.6/rustdesk-1.2.6-x86_64.exe" -OutFile "C:\rustdesk.exe"
        shell: pwsh

      - name: Install RustDesk Silently
        run: |
          Start-Process -FilePath "C:\rustdesk.exe" -ArgumentList "/S" -NoNewWindow -Wait
        shell: pwsh

      - name: Verify RustDesk Installation
        run: |
          if (Test-Path "C:\Program Files\RustDesk\RustDesk.exe") {
            Write-Host "✅ RustDesk installed successfully."
          } else {
            Write-Host "❌ RustDesk installation failed."
            exit 1
          }
        shell: pwsh
